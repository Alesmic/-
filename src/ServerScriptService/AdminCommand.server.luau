local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- å¼•ç”¨ä½ ç²¾ç®€åçš„ GameConfig
local GameConfig = require(ReplicatedStorage:WaitForChild("GameConfig"))

Players.PlayerAdded:Connect(function(player)
	player.Chatted:Connect(function(message)
		local args = string.split(message, " ")
		local command = string.lower(args[1])
		local value = tonumber(args[2])

		-- è·å–æ•°æ®ç›®å½•ï¼ˆå‡è®¾ä½ å·²åœ¨ Leaderstats ä¸­åˆ›å»ºäº†è¿™äº›æ•°å€¼ï¼‰
		local leaderstats = player:FindFirstChild("leaderstats")
		if not leaderstats then return end

		-- ==========================================
		-- æŒ‡ä»¤ 1: è®¾ç½® $MTC ä½™é¢ (/mtc æ•°é‡)
		-- å¯¹åº”æ•™å­¦ä¸­çš„ Metacoins è®¡æ•°å™¨ 
		-- ==========================================
		if (command == "/mtc" or command == "/money") and value then
			local mtcStat = leaderstats:FindFirstChild("MTC") or leaderstats:FindFirstChild("Gold")
			if mtcStat then
				mtcStat.Value = value
				print("âš™ ç®¡ç†å‘˜: $MTC å·²è®¾ç½®ä¸º " .. value)
			end
		end

		-- ==========================================
		-- æŒ‡ä»¤ 2: è®¾ç½®ç”Ÿç‰©è´¨æ•°é‡ (/bio æ•°é‡)
		-- å¯¹åº”æ•™å­¦ä¸­çš„ Bio-matter è®¡æ•°å™¨ [cite: 42, 61]
		-- ==========================================
		if (command == "/bio" or command == "/salvage") and value then
			local bioStat = leaderstats:FindFirstChild("BioMatter")
			if bioStat then
				bioStat.Value = value
				print("âš™ ç®¡ç†å‘˜: ç”Ÿç‰©è´¨è®¡æ•°å™¨å·²è®¾ç½®ä¸º " .. value)
			end
		end

		-- ==========================================
		-- æŒ‡ä»¤ 3: ç›´æ¥è·å¾—æ•™å­¦æå–ç‰© (/getextracts)
		-- è‡ªåŠ¨æŒ‰ç…§æ•™å­¦é…ç½®è·å¾—æŒ‡å®šæ•°é‡çš„æå–ç‰© 
		-- ==========================================
		if command == "/getextracts" then
			local inventory = player:FindFirstChild("Inventory")
			if inventory then
				-- ä» GameConfig ä¸­è¯»å–æ•™å­¦ Elite Zombie çš„æ‰è½é…ç½®
				local dropInfo = GameConfig.Mobs["Elite Zombie"].Drops [cite: 45]

				for _, drop in ipairs(dropInfo) do
					local item = inventory:FindFirstChild(drop.ItemName)
					if not item then
						item = Instance.new("IntValue")
						item.Name = drop.ItemName
						item.Parent = inventory
					end
					item.Value = item.Value + drop.Amount
				end
				print("ğŸ ç®¡ç†å‘˜: å·²å‘æ”¾æ•™å­¦æ‰€éœ€çš„å…¨éƒ¨æå–ç‰©")
			end
		end

		-- ==========================================
		-- æŒ‡ä»¤ 4: ç¬é—´ç§»åŠ¨åˆ°å®éªŒå®¤ (/lab)
		-- å¯¹åº”æ•™å­¦ Objective #3 çš„åœ°å›¾è½¬æ¢ 
		-- ==========================================
		if command == "/lab" then
			local character = player.Character
			if character and character:FindFirstChild("HumanoidRootPart") then
				-- å‡è®¾ä½ çš„å®éªŒå®¤åœ°å›¾æœ‰ä¸€ä¸ªåä¸º "LabSpawn" çš„é›¶ä»¶
				local labSpawn = workspace:FindFirstChild("LabSpawn")
				if labSpawn then
					character.HumanoidRootPart.CFrame = labSpawn.CFrame
					print("ğŸš€ ç®¡ç†å‘˜: å·²ä¼ é€è‡³å®éªŒå®¤")
				else
					warn("âŒ æœªæ‰¾åˆ° LabSpawn é›¶ä»¶")
				end
			end
		end
	end)
end)